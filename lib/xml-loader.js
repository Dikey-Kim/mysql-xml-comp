var fs=require("fs"),path=require("path"),xml2js=require("xml2js"),Promise=require("promise"),logging=function(){};function checkPath(a,b){var c=path.resolve(a);fs.exists(c,function(a){a?b(null,c):b(Error(c+"is not Directory"))})}function fileLoad(a){return new Promise(function(b,c){var e=new xml2js.Parser({trim:!0,explicitArray:!1});fs.readFile(a,function(d,f){if(d)return c(d);e.parseString(f,function(d,g){if(d)return c(d);logging("[MySQL-Init]XML File Load -> "+a);return b(g)})})})}
module.exports=function(a,b){checkPath(a,function(a,e){if(a)return b(a);fs.readdir(e,function(a,c){var d=[];if(a)return b(a);c.forEach(function(a){a.toLowerCase().lastIndexOf(".xml")===a.length-4&&d.push(fileLoad(e+path.sep+a))});Promise.all(d).then(function(a){var c={};a.forEach(function(a){if(a)for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])});b(null,c)})["catch"](function(a){b(a)})})})};module.exports.setLogger=function(a){logging=a};